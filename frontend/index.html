<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <title>SD 1.5 Text-to-Image</title>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600&display=swap" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />
</head>

<body>
    <div class="app">
        <header class="header">
            <h1>Synthia Engine</h1>
            <div id="nav-root"></div>
        </header>

        <div class="layout">
            <section class="controls">
                <label class="field">
                    <span>Model</span>
                    <select id="model_select">
                        <option value="" disabled selected>Loading models...</option>
                    </select>
                </label>

                <label class="field">
                    <span>Prompt</span>
                    <textarea id="prompt" placeholder="Enter prompt..."></textarea>
                </label>

                <label class="field">
                    <span>Negative Prompt</span>
                    <textarea id="negative_prompt" class="textarea-small" placeholder="Optional negative prompt..."></textarea>
                </label>

                <div class="controlnet-panel">
                    <button class="controlnet-toggle" type="button" id="controlnet-toggle">
                        <span class="indicator" id="controlnet-indicator"></span>
                        <span>ControlNet Preprocessors</span>
                        <span class="chevron" id="controlnet-chevron">â–¾</span>
                    </button>
                    <div class="controlnet-content" id="controlnet-content">
                        <label class="field field-inline">
                            <input type="checkbox" id="controlnet-enabled" />
                            <span>Enable ControlNet</span>
                        </label>
                        <button class="secondary" id="open-preprocessors" type="button">Open Preprocessors</button>
                        <div class="controlnet-status" id="controlnet-status">No preprocessor applied.</div>
                    </div>
                </div>

                <div class="field-row">
                    <label class="field">
                        <span>Seed</span>
                        <input id="seed" type="number" value="0" step="1" />
                    </label>
                    <label class="field">
                        <span>Steps</span>
                        <input id="steps" type="number" value="20" step="1" />
                    </label>
                </div>

                <div class="field-row">
                    <label class="field">
                        <span>CFG</span>
                        <input id="cfg" type="number" step="0.5" value="7.5" />
                    </label>

                    <label class="field">
                        <span>Scheduler</span>
                        <select id="scheduler">
                            <option value="ddim">DDIM</option>
                            <option value="dpm++2m">DPM++ 2M</option>
                            <option value="dpm++2m_karras">DPM++ 2M Karras</option>
                            <option value="dpm++2m_sde">DPM++ 2M SDE</option>
                            <option value="dpm++2m_sde_karras">DPM++ 2M SDE Karras</option>
                            <option value="dpm++_sde">DPM++ SDE</option>
                            <option value="dpm++_sde_karras">DPM++ SDE Karras</option>
                            <option value="dpm2">DPM2</option>
                            <option value="dpm2_karras">DPM2 Karras</option>
                            <option value="dpm2_a">DPM2 a</option>
                            <option value="dpm2_a_karras">DPM2 a Karras</option>
                            <option value="euler">Euler</option>
                            <option value="euler_a">Euler a</option>
                            <option value="heun">Heun</option>
                            <option value="lms">LMS</option>
                            <option value="lms_karras">LMS Karras</option>
                            <option value="deis">DEIS</option>
                            <option value="unipc">UniPC</option>
                        </select>
                    </label>
                </div>

                <div class="field-row">
                    <label class="field">
                        <span>Width</span>
                        <input id="width" type="number" value="512" step="8" min="64" />
                    </label>
                    <label class="field">
                        <span>Height</span>
                        <input id="height" type="number" value="512" step="8" min="64" />
                    </label>
                </div>

                <label class="field">
                    <span>Clip Skip</span>
                    <input id="clip_skip" type="number" value="1" min="0" max="8" />
                </label>

                <label class="field">
                    <span>Images</span>
                    <input id="num_images" type="number" value="1" min="1" max="8" />
                </label>

                <button class="primary" onclick="generate()">Generate</button>
            </section>

            <section class="gallery-panel">
                <div class="gallery-header">
                    <h2>Gallery</h2>
                    <p>Outputs appear here as they render.</p>
                </div>
                <div class="viewer">
                    <div class="viewer-frame">
                        <div id="viewer-empty" class="viewer-empty">No images yet</div>
                        <img id="viewer-image" alt="Generated output" />
                    </div>
                    <div class="viewer-controls">
                        <button id="viewer-prev" class="secondary" type="button">Prev</button>
                        <span id="viewer-count">0 / 0</span>
                        <button id="viewer-next" class="secondary" type="button">Next</button>
                    </div>
                    <div id="viewer-thumbs" class="viewer-thumbs"></div>
                </div>
            </section>
        </div>
    </div>

    <div class="modal hidden" id="preprocessor-modal" aria-hidden="true">
        <div class="modal-overlay" id="preprocessor-overlay"></div>
        <div class="modal-content" role="dialog" aria-modal="true" aria-labelledby="preprocessor-title">
            <div class="modal-header">
                <h2 id="preprocessor-title">ControlNet Preprocessors (SD1.5)</h2>
                <button class="secondary" id="close-preprocessors" type="button">Close</button>
            </div>
            <div class="modal-body">
                <label class="field">
                    <span>Preprocessor</span>
                    <select id="preprocessor-select"></select>
                </label>
                <p class="preprocessor-description" id="preprocessor-description"></p>
                <label class="field">
                    <span>Input Image</span>
                    <input id="preprocessor-image" type="file" accept="image/*" />
                </label>
                <div class="field-row" id="canny-thresholds">
                    <label class="field">
                        <span>Low Threshold</span>
                        <input id="preprocessor-low-threshold" type="number" min="0" max="255" value="100" />
                    </label>
                    <label class="field">
                        <span>High Threshold</span>
                        <input id="preprocessor-high-threshold" type="number" min="0" max="255" value="200" />
                    </label>
                </div>
                <button class="primary" id="apply-preprocessor" type="button">Apply Preprocessor</button>
                <div class="preprocessor-preview">
                    <span>Preview</span>
                    <img id="preprocessor-preview" alt="Preprocessor output preview" />
                    <a
                        id="download-control-image"
                        class="secondary controlnet-download is-disabled"
                        href="#"
                        download="controlnet_preprocessor.png"
                        aria-disabled="true"
                    >
                        Download Control Image
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script src="nav_bar.js?v=1"></script>
    <script src="gallery.js?v=1"></script>
    <script src="app.js?v=1"></script>
</body>

</html>
